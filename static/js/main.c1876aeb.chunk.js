(this["webpackJsonpcanvas-app"]=this["webpackJsonpcanvas-app"]||[]).push([[0],{62:function(e,t,n){},63:function(e,t,n){},65:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},84:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),i=n(10),a=n.n(i),c=(n(62),n(7)),o=(n(63),n(46)),u=n(2);var l=function(e,t){var n=t.expiryTimestamp,s=Object(o.useTimer)({expiryTimestamp:n,onExpire:function(){return console.warn("onExpire called")}}),i=s.seconds,a=s.minutes,l=s.hours,m=(s.days,s.isRunning,s.start,s.pause),f=(s.resume,s.restart),h=Object(r.useState)(10),j=Object(c.a)(h,2),b=j[0],d=j[1],g=Object(r.useState)(new Date),v=Object(c.a)(g,2),p=v[0],O=v[1],x=Object(r.useState)(new Date),T=Object(c.a)(x,2),k=T[0],y=T[1];return Object(r.useEffect)((function(){d(10),O(new Date),y(new Date),k.setSeconds(p.getSeconds()+b),f(k)}),[]),Object(u.jsxs)("div",{className:"flex",children:[Object(u.jsxs)("div",{style:{fontSize:"500%"},children:[Object(u.jsx)("span",{children:("00"+a).slice(-2)}),":",Object(u.jsx)("span",{children:("00"+i).slice(-2)})]}),Object(u.jsx)("button",{className:"button",onClick:function(){m();var t=3600*l+60*a+i,n=b;if(t>0)n=b-t;else{var r=new Date;n=3600*r.getHours()+60*r.getMinutes()+r.getSeconds()-(3600*p.getHours()+60*p.getMinutes()+p.getSeconds())}n=e.timeInfo.toNextPresenter(n);var s=new Date,c=new Date;c.setSeconds(s.getSeconds()+n),f(c),d(n),O(s),y(c)},children:"  \u5207\u66ff  "})]})};n(65);var m=function(e){var t=Object(r.useState)(e.timeInfo.getStartTime().getHours()),n=Object(c.a)(t,2),s=n[0],i=n[1],a=Object(r.useState)(e.timeInfo.getStartTime().getMinutes()),o=Object(c.a)(a,2),l=o[0],m=o[1],f=Object(r.useState)(e.timeInfo.getEndTime().getHours()),h=Object(c.a)(f,2),j=h[0],b=h[1],d=Object(r.useState)(e.timeInfo.getEndTime().getMinutes()),g=Object(c.a)(d,2),v=g[0],p=g[1],O=Object(r.useState)(e.timeInfo.getNumPresenters()),x=Object(c.a)(O,2),T=x[0],k=x[1],y=Object(r.useState)(e.timeInfo.getPresenters()),P=Object(c.a)(y,2),I=P[0],S=P[1],N=Object(r.useState)(e.timeInfo.getPresentTime()),w=Object(c.a)(N,2),C=w[0],D=w[1],E=Object(r.useState)(e.timeInfo.getBreakTime()),M=Object(c.a)(E,2),B=M[0],A=M[1],H=function(t){T>1&&(e.timeInfo.deletePresenter(t),S(e.timeInfo.getPresenters()),k(e.timeInfo.getNumPresenters()))},L=function(t,n){n?e.timeInfo.addPresenter(t+1,"break",600):e.timeInfo.addPresenter(t+1,"",1200),S(e.timeInfo.getPresenters()),k(e.timeInfo.getNumPresenters())},R=function(t){var n=t.target.value,r=Number(t.target.name.split("_")[1]),s=I.slice();s[r].name=n,e.timeInfo.setPresenters(s),S(e.timeInfo.getPresenters())};return Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{children:"\u8a2d\u5b9a\u9805\u76ee"}),Object(u.jsx)("p",{children:"\u958b\u59cb\u6642\u9593"}),Object(u.jsx)("input",{type:"time",name:"startTime",value:("00"+s).slice(-2)+":"+("00"+l).slice(-2),onChange:function(t){var n=t.target.value.split(":").map(Number),r=Object(c.a)(n,2),s=r[0],a=r[1],o=new Date;o.setHours(s),o.setMinutes(a),e.timeInfo.setStartTime(o),i(s),m(a)}}),Object(u.jsx)("p",{children:"\u7d42\u4e86\u6642\u9593"}),Object(u.jsx)("input",{type:"time",name:"endTime",value:("00"+j).slice(-2)+":"+("00"+v).slice(-2),onChange:function(t){var n=t.target.value.split(":").map(Number),r=Object(c.a)(n,2),s=r[0],i=r[1],a=new Date;a.setHours(s),a.setMinutes(i),e.timeInfo.setEndTime(a),b(s),p(i)}}),Object(u.jsxs)("p",{children:["\u767a\u8868\u4eba\u6570",T,"\u4eba"]}),Object(u.jsx)("input",{type:"number",name:"numPresenters",value:T,min:"1",max:"20",onChange:function(t){var n=Number(t.target.value);e.timeInfo.setNumPresenters(n),k(e.timeInfo.getNumPresenters()),S(e.timeInfo.getPresenters())}}),Object(u.jsx)("p",{children:"\u767a\u8868\u8005"}),Object(u.jsx)("div",{className:"presenter",children:I.map((function(e,t){return"break"===e.name?Object(u.jsxs)("div",{className:"flex",children:[Object(u.jsx)("button",{className:"namebutton",onClick:function(){return H(t)},children:"x"}),Object(u.jsx)("input",{type:"text",name:"presenter_"+t,value:e.name,onChange:R,disabled:!0}),Object(u.jsx)("button",{className:"namebutton",onClick:function(){return L(t,!1)},children:"+\u767a\u8868\u8005"})]}):Object(u.jsxs)("div",{className:"flex",children:[Object(u.jsx)("button",{className:"namebutton",onClick:function(){return H(t)},children:"x"}),Object(u.jsx)("input",{type:"text",name:"presenter_"+t,value:e.name,onChange:R}),Object(u.jsx)("button",{className:"namebutton",onClick:function(){return L(t,!1)},children:"+\u767a\u8868\u8005"}),Object(u.jsx)("button",{className:"namebutton",onClick:function(){return L(t,!0)},children:"+\u4f11\u61a9"})]})}))}),Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{children:"\u5404\u767a\u8868\u6642\u9593"}),Object(u.jsx)("input",{type:"number",value:C,onChange:function(t){var n=Number(t.target.value);e.timeInfo.setPresentTime(n),S(e.timeInfo.getPresenters()),D(e.timeInfo.getPresentTime())}})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{children:"\u4f11\u61a9\u6642\u9593"}),Object(u.jsx)("input",{type:"number",value:B,onChange:function(t){var n=Number(t.target.value);e.timeInfo.setBreakTime(n),S(e.timeInfo.getPresenters()),A(e.timeInfo.getBreakTime())}})]})]})},f=n(39),h=n.n(f);h.a.setAppElement("#root");var j,b=function(e){var t=s.a.useState(!1),n=Object(c.a)(t,2),r=n[0],i=n[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)("button",{onClick:function(){i(!0)},children:"\u8a2d\u5b9a"}),Object(u.jsxs)(h.a,{isOpen:r,children:[Object(u.jsx)("button",{onClick:function(){i(!1)},children:"\u9589\u3058\u308b"}),Object(u.jsx)(m,{timeInfo:e.timeInfo})]})]})},d=40,g=920,v=70,p=["red","blue","black","green","orange"],O=null,x=null,T=null,k=null;function y(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60);return(t<10?"0"+String(t):String(t))+":"+(n<10?"0"+String(n):String(n))}function P(e){var t=e.split(":");return 3600*Number(t[0])+60*Number(t[1])+Number(t[2])}function I(e,t,n,r,s,i){if(j=new Date,e){t.current&&e.clearRect(0,0,t.current.width,t.current.height);var a=function(e,t,n){for(var r,s=new Array(n.length-1),i=t-e,a=0;a<n.length-1;a++){r=0;for(var c=0;c<=a;c++)r+=n[c];s[a]=d+r/i*880}return s}(n,r,i);e.globalAlpha=1,e.strokeStyle="black",e.textAlign="center",e.beginPath(),e.moveTo(d,30),e.lineTo(d,110),e.stroke(),e.font="25px serif",e.fillText(s[0],(d+a[0])/2,45),e.font="30px serif",e.fillText(y(n),d,140),e.beginPath(),e.moveTo(g,30),e.lineTo(g,110),e.stroke(),e.font="25px serif",e.fillText(s[s.length-1],(a[a.length-1]+g)/2,45),e.font="30px serif",e.fillText(y(r),g,140);for(var c=0;c<a.length+1;c++)if(e.strokeStyle="black",e.beginPath(),e.moveTo(a[c],30),e.lineTo(a[c],110),e.stroke(),e.strokeStyle=p[c],e.beginPath(),0==c?e.moveTo(d,v):e.moveTo(a[c-1],v),c<a.length-1?e.lineTo(a[c],v):e.lineTo(g,v),e.stroke(),c<a.length){for(var o=0,u=0;u<=c;u++)o+=i[u];c>0&&(e.font="25px serif",e.fillText(s[c],(a[c-1]+a[c])/2,45)),e.font="30px serif",e.fillText(y(n+o),a[c],140)}var l=j.toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),m=function(e,t,n){var r=n-t,s=P(e);return d+(s-t)/r*880}(l,n,r);e.strokeStyle="black",e.beginPath(),e.moveTo(m-20,50),e.lineTo(m,v),e.stroke(),e.beginPath(),e.moveTo(m-20,90),e.lineTo(m,v),e.stroke(),e.font="20px serif",e.fillText(l,m,110)}}var S=function(e){var t,n,s=r.useRef(null),i=r.useState(null),a=Object(c.a)(i,2),o=a[0],l=a[1],m=r.useState(e.timeInfo.getStartTime()),f=Object(c.a)(m,2),h=f[0],j=f[1],b=r.useState(e.timeInfo.getEndTime()),d=Object(c.a)(b,2),g=d[0],v=d[1],p=r.useState(e.timeInfo.getPresenters()),y=Object(c.a)(p,2),S=y[0],N=y[1],w=[],C=[];O&&clearInterval(O),O=setInterval((function(){j(e.timeInfo.getStartTime())}),100),t=P(h.toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})),x&&clearInterval(x),x=setInterval((function(){v(e.timeInfo.getEndTime())}),100),n=P(g.toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})),T&&clearInterval(T),T=setInterval((function(){N(e.timeInfo.getPresenters())}),100);for(var D=0;D<S.length;D++)w.push(S[D].name),C.push(S[D].time);return r.useEffect((function(){if(s.current){s.current.style.position="absolute",s.current.style.left="280px",s.current.style.top="10px",k&&clearInterval(k),k=setInterval((function(){I(o,s,t,n,w,C)}),10);var e=s.current.getContext("2d");e&&l(e)}I(o,s,t,n,w,C)}),[o,h,g,S]),Object(u.jsx)("div",{style:{textAlign:"center"},children:Object(u.jsx)("canvas",{id:"canvas",ref:s,width:960,height:150,style:{border:"2px solid #000",marginTop:10}})})};var N=function(e){var t=r.useRef(null),n=r.useState(null),s=Object(c.a)(n,2),i=s[0],a=s[1];return r.useEffect((function(){if(t.current){var e=t.current.getContext("2d");e&&a(e)}}),[i]),Object(u.jsxs)("div",{style:{textAlign:"center"},children:[Object(u.jsx)("canvas",{id:"canvas",ref:t,width:1e3,height:300,style:{border:"2px solid #000",marginTop:10}}),Object(u.jsx)(S,{timeInfo:e.timeInfo}),Object(u.jsx)(l,{timeInfo:e.timeInfo}),Object(u.jsx)(b,{timeInfo:e.timeInfo})]})},w=n(40),C=(n(77),function(e){var t=e.title,n=e.setSelectedTab,s=e.index,i=Object(r.useCallback)((function(){n(s)}),[n,s]);return Object(u.jsx)("li",{children:Object(u.jsx)("button",{onClick:i,children:t})})}),D=(n(78),function(e){var t=e.children,n=Object(r.useState)(0),s=Object(c.a)(n,2),i=s[0],a=s[1];return Object(u.jsxs)("div",{className:"tabs",children:[Object(u.jsx)("ul",{className:"nav",children:t.map((function(e,t){return Object(u.jsx)(C,{title:e.props.presenter.name,index:t,setSelectedTab:a},t)}))}),t[i]]})}),E=(n(79),function(e){var t=e.children;return Object(u.jsx)("div",{className:"box",children:Object(u.jsx)("div",{className:"Memo",children:t})})}),M=(n(80),n(118)),B=n(121),A=n(123),H=n(127),L=(n(81),Object(M.a)((function(e){return{root:{backgroundColor:e.palette.background.paper},inline:{display:"inline"}}}))),R=function(e){var t=Object(r.useState)(e.chats),n=Object(c.a)(t,2),s=n[0],i=(n[1],L());return Object(u.jsx)("div",{style:{maxHeight:200,overflow:"auto"},children:s.map((function(e,t){return Object(u.jsx)(B.a,{className:i.root,children:Object(u.jsx)(A.a,{alignItems:"flex-start",children:Object(u.jsx)(H.a,{primary:e})})},t)}))})},F=n(126),J=(n(84),n(124)),_=n(125),z=Object(M.a)((function(e){return{button:{margin:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},iconSmall:{fontSize:14}}})),V=function(e){var t=z();return Object(u.jsx)(J.a,{variant:"contained",color:"primary",className:t.button,onClick:function(t){e.onSendButtonClick(t)},children:Object(u.jsx)(_.a,{children:"send"})})},W=function(e){return Object(u.jsx)(s.a.Fragment,{children:Object(u.jsxs)("form",{className:"wrap",noValidate:!0,autoComplete:"off",children:[Object(u.jsx)(F.a,{id:"standard-text",label:"\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u5165\u529b",className:"text",margin:"normal",onChange:function(t){e.onChatChange(t.target.value)}}),Object(u.jsx)(V,{onSendButtonClick:function(t){return function(t){e.onButtonClick(t)}(t)}})]})})},q=function(e){var t,n=Object(r.useState)(e.chats),i=Object(c.a)(n,2),a=i[0],o=i[1],l=Object(r.useState)(!1),m=Object(c.a)(l,2),f=m[0],h=m[1];return Object(u.jsx)(s.a.Fragment,{children:Object(u.jsxs)("div",{className:"Chat",children:[Object(u.jsx)(R,{chats:a}),Object(u.jsx)(W,{onChatChange:function(e){t=e},onButtonClick:function(){var n=a;n.push(t),o(n),h(!f),console.log(e.chats)}})]})})},G=function(e){var t=e.presenter,n=(t.name,t.memo),r=t.chats;return Object(u.jsx)("div",{className:"presenter-tab",children:Object(u.jsx)(E,{title:"a",children:Object(u.jsxs)("div",{className:"box",children:[Object(u.jsx)("div",{className:"field",children:Object(u.jsx)("textarea",{className:"memo",value:n,onChange:function(t){e.onMemoChange(e.presenter.id,t.target.value)}})}),Object(u.jsx)("div",{className:"field",children:Object(u.jsx)(q,{chats:r})})]})})})},K=function(e){for(var t=new Array(e.presenterNum),n=0;n<e.presenterNum;n++)t[n]={id:n,name:e.presenters[n],memo:"",chats:[""]};var s=Object(r.useState)(t),i=Object(c.a)(s,2),a=i[0],o=i[1],l=a.map((function(e){return Object(u.jsx)(G,{presenter:e,onMemoChange:function(e,t){return function(e,t){var n=a.map((function(n){return n.id===e?Object(w.a)(Object(w.a)({},n),{},{memo:t}):n}));o(n)}(e,t)}},e.id)}));return Object(u.jsx)("div",{children:Object(u.jsx)(D,{children:l})})};var Q=function(e){for(var t=r.useRef(null),n=r.useState(null),s=Object(c.a)(n,2),i=s[0],a=s[1],o=e.timeInfo.getPresenters(),l=e.timeInfo.getNumPresenters(),m=new Array(l),f=0;f<l;f++)m[f]=o[f].name;return r.useEffect((function(){if(t.current){var e=t.current.getContext("2d");e&&a(e)}}),[i]),Object(u.jsx)("div",{style:{textAlign:"center"},children:Object(u.jsx)("div",{className:"content",children:Object(u.jsx)(K,{presenters:m,presenterNum:l})})})},U=n(29),X=n(33),Y=n(34),Z=function(){function e(){Object(X.a)(this,e),this.startTime=new Date,this.endTime=new Date,this.numPresenters=1,this.presenters=new Array(this.numPresenters).fill({name:"",time:0}),this.nowPresenterIndex=-1,this.presentTime=0,this.breakTime=0,this.startTime.setHours(13),this.endTime.setHours(16),this.numPresenters=5,this.presenters=[{name:"abc",time:10},{name:"def",time:1500},{name:"break",time:600},{name:"ghi",time:1500},{name:"jkl",time:1500}]}return Object(Y.a)(e,[{key:"getStartTime",value:function(){return this.startTime}},{key:"getEndTime",value:function(){return this.endTime}},{key:"setStartTime",value:function(e){this.startTime=e}},{key:"setEndTime",value:function(e){this.endTime=e}},{key:"getNumPresenters",value:function(){return this.numPresenters}},{key:"setNumPresenters",value:function(e){if(this.numPresenters=this.presenters.length,e>=1)if(e>this.presenters.length)for(var t=0;t<e-this.presenters.length;t++)this.addPresenter(this.presenters.length,"",0);else if(e<this.presenters.length)for(t=0;t<this.presenters.length-e;t++)this.deletePresenter(this.presenters.length-1)}},{key:"addNumPresenters",value:function(e){if(this.numPresenters=this.presenters.length,this.numPresenters+e>=1)if(e>0)for(var t=0;t<e;t++)this.addPresenter(this.presenters.length,"",0);else if(e<0)for(t=0;t<-e;t++)this.deletePresenter(this.presenters.length-1);this.endTime.setSeconds(this.endTime.getSeconds()+60),this.endTime=new Date(this.endTime)}},{key:"getPresenters",value:function(){return this.presenters}},{key:"setPresenters",value:function(e){this.presenters=e}},{key:"deletePresenter",value:function(e){this.presenters=this.presenters.slice(0,e).concat(this.presenters.slice(e+1,this.presenters.length)),this.numPresenters-=1}},{key:"addPresenter",value:function(e,t,n){this.presenters.splice(e,0,{name:t,time:n}),this.numPresenters+=1}},{key:"getNowPresenterIndex",value:function(){return this.nowPresenterIndex}},{key:"toNextPresenter",value:function(e){return this.nowPresenterIndex>=0&&(this.presenters[this.nowPresenterIndex].time=e),this.nowPresenterIndex+=1,this.presenters[this.nowPresenterIndex].time}},{key:"getPresentTime",value:function(){return this.presentTime}},{key:"setPresentTime",value:function(e){this.presentTime=e;var t,n=Object(U.a)(this.presenters);try{for(n.s();!(t=n.n()).done;){var r=t.value;"break"!==r.name&&(r.time=60*e)}}catch(s){n.e(s)}finally{n.f()}}},{key:"getNowPresentDate",value:function(){for(var e=0,t=0;t<this.nowPresenterIndex;t++)e+=this.presenters[t].time;var n=new Date;n.setSeconds(this.startTime.getSeconds()+e);var r=new Date;return r.setSeconds(this.startTime.getSeconds()+e+this.presenters[this.nowPresenterIndex].time),[n,r]}},{key:"getBreakTime",value:function(){return this.breakTime}},{key:"setBreakTime",value:function(e){this.breakTime=e;var t,n=Object(U.a)(this.presenters);try{for(n.s();!(t=n.n()).done;){var r=t.value;"break"===r.name&&(r.time=60*e)}}catch(s){n.e(s)}finally{n.f()}}},{key:"getPresenterList",value:function(){var e,t=[],n=Object(U.a)(this.presenters);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r.name)}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"setPresenterList",value:function(e){for(var t=0;t<this.presenters.length;t++)this.presenters[t].name=e[t]}},{key:"getTimeSetting",value:function(){var e,t=[],n=Object(U.a)(this.presenters);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r.time)}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"setTimeSetting",value:function(e){for(var t=0;t<this.presenters.length;t++)this.presenters[t].time=e[t]}},{key:"sendTimeInfo",value:function(){this.getPresenterList(),this.startTime,this.endTime,this.presentTime,this.breakTime}},{key:"sendChangePresenter",value:function(){this.nowPresenterIndex,this.getTimeSetting()}}]),e}(),$=n(48),ee=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $.EventEmitter;Object(X.a)(this,e),this.ws=void 0,this.ee=void 0,this.ws=t,this.ee=n,t.onmessage=this.message.bind(this),t.onopen=this.open.bind(this),t.onclose=this.close.bind(this),t.onerror=this.error.bind(this)}return Object(Y.a)(e,[{key:"on",value:function(e,t){this.ee.on(e,t)}},{key:"off",value:function(e,t){this.ee.removeListener(e,t)}},{key:"open",value:function(){this.ee.emit("connect")}},{key:"close",value:function(){this.ee.emit("disconnect")}},{key:"error",value:function(e){console.log("websocket error: ",e)}},{key:"emit",value:function(e){this.ws.send(e)}},{key:"message",value:function(e){try{this.ee.emit("message",e)}catch(t){this.ee.emit("error",t),console.log(Date().toString()+": ",t)}}}]),e}(),te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,129)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),s(e),i(e),a(e)}))},ne=new Z,re=new ee(new WebSocket("wss://warm-gorge-29708.herokuapp.com/ws"));re.on("message",(function(e){var t=JSON.parse(e.data);console.log(t)})),a.a.render(Object(u.jsxs)(s.a.StrictMode,{children:[Object(u.jsx)(N,{timeInfo:ne}),Object(u.jsx)(Q,{timeInfo:ne}),Object(u.jsx)("button",{onClick:function(){var e=JSON.stringify({messagetype:"memo",message:"React!"});console.log(e),re.emit(e)},children:"\u9001\u4fe1"})]}),document.getElementById("root")),te()}},[[86,1,2]]]);
//# sourceMappingURL=main.c1876aeb.chunk.js.map